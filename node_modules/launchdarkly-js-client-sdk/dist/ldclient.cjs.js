"use strict";function e(n,e){var t,r=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),r.push.apply(r,t)),r}function n(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(e){r(n,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}()||function(e){if(e){if("string"==typeof e)return o(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,void 0):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function a(e){function n(e,n){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=e,this.code=n}return(n.prototype=new Error).name=e,n.prototype.constructor=n}Object.defineProperty(exports,"__esModule",{value:!0});var u=a("LaunchDarklyUnexpectedResponseError"),s=a("LaunchDarklyInvalidEnvironmentIdError"),c=a("LaunchDarklyInvalidUserError"),l=a("LaunchDarklyInvalidEventKeyError"),f=a("LaunchDarklyInvalidArgumentError"),v=a("LaunchDarklyFlagFetchError"),d=a("LaunchDarklyInvalidDataError");function g(e){return!(400<=e&&e<500)||400===e||408===e||429===e}for(var p=Object.freeze({__proto__:null,LDUnexpectedResponseError:u,LDInvalidEnvironmentIdError:s,LDInvalidUserError:c,LDInvalidEventKeyError:l,LDInvalidArgumentError:f,LDFlagFetchError:v,LDInvalidDataError:d,isHttpErrorRecoverable:g}),m=function(e){for(var n,t=e.length,r=t%3,o=[],i=0,a=t-r;i<a;i+=16383)o.push(w(e,i,a<i+16383?a:i+16383));return 1==r?(n=e[t-1],o.push(y[n>>2]+y[n<<4&63]+"==")):2==r&&(n=(e[t-2]<<8)+e[t-1],o.push(y[n>>10]+y[n>>4&63]+y[n<<2&63]+"=")),o.join("")},y=[],h=[],b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=0,E=b.length;k<E;++k)y[k]=b[k],h[b.charCodeAt(k)]=k;function w(e,n,t){for(var r,o=[],i=n;i<t;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(y[(r=r)>>18&63]+y[r>>12&63]+y[r>>6&63]+y[63&r]);return o.join("")}h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63;var D=Array.isArray,O=Object.keys,S=Object.prototype.hasOwnProperty,P=["key","secondary","ip","country","email","firstName","lastName","avatar","name"];function U(e,n){return(e.endsWith("/")?e.substring(0,e.length-1):e)+(n.startsWith("/")?"":"/")+n}function I(e){e=unescape(encodeURIComponent(e));return m(function(e){for(var n=[],t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}(e))}function j(e){return I(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function T(e){return JSON.parse(JSON.stringify(e))}function R(e,n){return function e(n,t){if(n===t)return!0;if(n&&t&&"object"==typeof n&&"object"==typeof t){var r,o,i,a=D(n),u=D(t);if(a&&u){if((o=n.length)!=t.length)return!1;for(r=o;0!=r--;)if(!e(n[r],t[r]))return!1;return!0}if(a!=u)return!1;a=n instanceof Date,u=t instanceof Date;if(a!=u)return!1;if(a&&u)return n.getTime()==t.getTime();a=n instanceof RegExp,u=t instanceof RegExp;if(a!=u)return!1;if(a&&u)return n.toString()==t.toString();var s=O(n);if((o=s.length)!==O(t).length)return!1;for(r=o;0!=r--;)if(!S.call(t,s[r]))return!1;for(r=o;0!=r--;)if(!e(n[i=s[r]],t[i]))return!1;return!0}return n!=n&&t!=t}(e,n)}function A(e){setTimeout(e,0)}function L(e,n){e=e.then(function(e){return n&&setTimeout(function(){n(null,e)},0),e},function(e){if(!n)return Promise.reject(e);setTimeout(function(){n(e,null)},0)});return n?void 0:e}function C(e){var n,t={};for(n in e)V(e,n)&&(t[n]={value:e[n],version:0});return t}function F(e){var n,t={};for(n in e)V(e,n)&&(t[n]=e[n].value);return t}function N(e,n){for(var t,r=n.slice(0),o=[],i=e;0<r.length;){for(t=[];0<i;){var a=r.shift();if(!a)break;(i-=j(JSON.stringify(a)).length)<0&&0<t.length?r.unshift(a):t.push(a)}i=e,o.push(t)}return o}function x(e){var n=e.version||"3.6.0";return e.userAgent+"/"+n}function q(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(e,t){return n(n({},e),t)},{})}function V(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function _(e){if(!e)return e;var t,r;for(r in P){var o=P[r],i=e[o];void 0!==i&&"string"!=typeof i&&((t=t||n({},e))[o]=String(i))}return t||e}for(var z=Object.freeze({__proto__:null,appendUrlPath:U,btoa:I,base64URLEncode:j,clone:T,deepEquals:R,onNextTick:A,wrapPromiseCallback:L,transformValuesToVersionedValues:C,transformVersionedValuesToValues:F,chunkUserEventsForUrl:N,getLDUserAgentString:x,extend:q,objectHasOwnProperty:V,sanitizeUser:_}),J=function(e){var n=e={exports:{}},t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);{var r,o;t?(r=new Uint8Array(16),n.exports=function(){return t(r),r}):(o=new Array(16),n.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),o[n]=e>>>((3&n)<<3)&255;return o})}return e.exports}(),M=[],K=0;K<256;++K)M[K]=(K+256).toString(16).substr(1);var $,B,H=function(e,n){var n=n||0,t=M;return[t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],t[e[+n]]].join("")},G=0,W=0,X=function(e,n,t){var r=n&&t||0,o=n||[],i=(e=e||{}).node||$,t=void 0!==e.clockseq?e.clockseq:B,a=(null!=i&&null!=t||(a=J(),null==i&&(i=$=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==t&&(t=B=16383&(a[6]<<8|a[7]))),void 0!==e.msecs?e.msecs:(new Date).getTime()),u=void 0!==e.nsecs?e.nsecs:W+1,s=a-G+(u-W)/1e4;if(s<0&&void 0===e.clockseq&&(t=t+1&16383),1e4<=(u=(s<0||G<a)&&void 0===e.nsecs?0:u))throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");G=a,B=t;s=(1e4*(268435455&(a+=122192928e5))+(W=u))%4294967296,o[r++]=s>>>24&255,o[r++]=s>>>16&255,o[r++]=s>>>8&255,o[r++]=255&s,e=a/4294967296*1e4&268435455;o[r++]=e>>>8&255,o[r++]=255&e,o[r++]=e>>>24&15|16,o[r++]=e>>>16&255,o[r++]=t>>>8|128,o[r++]=255&t;for(var c=0;c<6;++c)o[r+c]=i[c];return n||H(o)},Q=["debug","info","warn","error","none"];function Y(e,s){if(e&&e.destination&&"function"!=typeof e.destination)throw new Error("destination for basicLogger was set to a non-function");function n(n){return function(e){console&&console[n]&&console[n].call(console,e)}}var c=e&&e.destination?[e.destination,e.destination,e.destination,e.destination]:[n("log"),n("info"),n("warn"),n("error")],l=!(!e||!e.destination),f=e&&void 0!==e.prefix&&null!==e.prefix?e.prefix:"[LaunchDarkly] ",t=1;if(e&&e.level)for(var r=0;r<Q.length;r++)Q[r]===e.level&&(t=r);for(var o={},a=function(e){var a,u=Q[e];"none"!==u&&(e<t?o[u]=function(){}:(a=e,o[u]=function(){var e=a,n=u,t=arguments;if(!(t.length<1)){var r=l?n+": "+f:f,o=1!==t.length&&s?((o=i(t))[0]=r+o[0],s.apply(void 0,i(o))):r+t[0];try{c[e](o)}catch(e){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+n+" method threw an exception: "+e)}}}))},u=0;u<Q.length;u++)a(u);return o}function Z(e,n){return Y({level:e,prefix:n})}function ee(e){return e&&e.message?e.message:"string"==typeof e||e instanceof String?e:JSON.stringify(e)}var ne=function(){return"LaunchDarkly client initialized"},te=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.",re=function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},ie=function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},oe=function(e){return'Expected application/json content type but got "'+e+'"'},ae=function(e){return"local storage is unavailable: "+ee(e)},ue=function(e){return"network error"+(e?" ("+e+")":"")},se=function(e){return'Custom event "'+e+'" does not exist'},ce=function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+te},le=function(){return"No environment/client-side ID was specified."+te},fe=function(e){return"Error fetching flag settings: "+ee(e)},ve=function(){return"No user specified."+te},de=function(){return"Invalid user specified."+te},ge=function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},pe=function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+te},me=function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},ye=function(e,n){return n?'"'+e+'" is deprecated, please use "'+n+'"':'"'+e+'" is deprecated'},he=function(e,n,t){return"Received error "+e+(401===e?" (invalid SDK key)":"")+" for "+n+" - "+(g(e)?t:"giving up permanently")},be=function(){return"Cannot make HTTP requests in this environment."+te},ke=function(){return"identify() has no effect here; it must be called on the main client instance"},Ee=function(){return"Closing stream connection"},we=function(e){return"Opening stream connection to "+e},De=function(e,n){return"Error on stream connection: "+ee(e)+", will continue retrying every "+n+" milliseconds."},Oe=function(e){return'Ignoring unknown config option "'+e+'"'},Se=function(e,n,t){return'Config option "'+e+'" should be of type '+n+", got "+t+", using default value"},Pe=function(e,n){return'Config option "'+e+'" should be a boolean, got '+n+", converting to boolean"},Ue=function(e,n,t){return'Config option "'+e+'" was set to '+n+", changing to minimum value of "+t},Ie=function(e){return"polling for feature flags at "+e},je=function(){return"received ping message from stream"},Te=function(){return"received streaming update for all flags"},Re=function(e){return'received streaming update for flag "'+e+'"'},Ae=function(e){return'received streaming update for flag "'+e+'" but ignored due to version check'},Le=function(e){return'received streaming deletion for flag "'+e+'"'},Ce=function(e){return'received streaming deletion for flag "'+e+'" but ignored due to version check'},Fe=function(e){return'enqueueing "'+e+'" event'},Ne=function(e){return"sending "+e+" events"},xe=function(e){return'Config option "'.concat(e,'" must only contain letters, numbers, ., _ or -.')},qe=Object.freeze({__proto__:null,clientInitialized:ne,clientNotReady:function(){return"LaunchDarkly client is not ready"},eventCapacityExceeded:re,eventWithoutUser:ie,invalidContentType:oe,invalidKey:function(){return"Event key must be a string"},localStorageUnavailable:ae,networkError:ue,unknownCustomEventKey:se,environmentNotFound:ce,environmentNotSpecified:le,errorFetchingFlags:fe,userNotSpecified:ve,invalidUser:de,invalidData:ge,bootstrapOldFormat:pe,bootstrapInvalid:me,deprecated:ye,httpErrorMessage:he,httpUnavailable:be,identifyDisabled:ke,streamClosing:Ee,streamConnecting:we,streamError:De,unknownOption:Oe,wrongOptionType:Se,wrongOptionTypeBoolean:Pe,optionBelowMinimum:Ue,debugPolling:Ie,debugStreamPing:je,debugStreamPut:Te,debugStreamPatch:Re,debugStreamPatchIgnored:Ae,debugStreamDelete:Le,debugStreamDeleteIgnored:Ce,debugEnqueueingEvent:Fe,debugPostingEvents:Ne,debugPostingDiagnosticEvent:function(e){return"sending diagnostic event ("+e.kind+")"},invalidTagValue:xe}),Ve={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},inlineUsersInEvents:{default:!1},allowFrequentDuplicateEvents:{default:!1},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributeNames:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},autoAliasingOptOut:{default:!1},application:{validator:function(e,n,t,r){var o={};return t.id&&(o.id=ze("".concat(e,".id"),n,t.id,r)),t.version&&(o.version=ze("".concat(e,".version"),n,t.version,r)),o}}},_e=/^(\w|\.|-)+$/;function ze(e,n,t,r){if("string"==typeof t&&t.match(_e))return t;r.warn(xe(e))}function Je(e,n,r,a){var u=q({logger:{default:a}},Ve,r),o={all_attributes_private:"allAttributesPrivate",private_attribute_names:"privateAttributeNames",samplingInterval:null};function s(e){A(function(){n&&n.maybeReportError(new f(e))})}var i,c,l,d,v,r=q({},e||{});return v=r,Object.keys(o).forEach(function(e){var n;void 0!==v[e]&&(n=o[e],a&&a.warn(ye(e,n)),n&&(void 0===v[n]&&(v[n]=v[e]),delete v[e]))}),i=(d=q({},r),Object.keys(u).forEach(function(e){void 0!==d[e]&&null!==d[e]||(d[e]=u[e]&&u[e].default)}),c=r=d,l=q({},c),Object.keys(c).forEach(function(e){var n,t,r,o,i=c[e];null!=i&&(void 0===(n=u[e])?s(Oe(e)):(t=n.type||g(n.default),(r=n.validator)?void 0!==(r=r(e,c,c[e],a))?l[e]=r:delete l[e]:"any"!==t&&(r=t.split("|"),o=g(i),r.indexOf(o)<0?"boolean"===t?(l[e]=!!i,s(Pe(e,o))):(s(Se(e,t,o)),l[e]=n.default):"number"===o&&void 0!==n.minimum&&i<n.minimum&&(s(Ue(e,i,n.minimum)),l[e]=n.minimum))))}),r=l).logger,Q.forEach(function(e){if("none"!==e&&(!i[e]||"function"!=typeof i[e]))throw new Error("Provided logger instance must support logger."+e+"(...) method")}),r;function g(e){if(null===e)return"any";if(void 0!==e){if(Array.isArray(e))return"array";e=t(e);return"boolean"===e||"string"===e||"number"===e||"function"===e?e:"object"}}}function Me(e){var n={};return e&&(e.application&&void 0!==e.application.id&&null!==e.application.id&&(n["application-id"]=[e.application.id]),e.application&&void 0!==e.application.version&&null!==e.application.id&&(n["application-version"]=[e.application.version])),n}function Ke(e,n){if(n&&!n.sendLDHeaders)return{};var e={"X-LaunchDarkly-User-Agent":x(e)},t=(n&&n.wrapperName&&(e["X-LaunchDarkly-Wrapper"]=n.wrapperVersion?n.wrapperName+"/"+n.wrapperVersion:n.wrapperName),Me(n)),n=Object.keys(t);return n.length&&(e["x-launchdarkly-tags"]=n.sort().flatMap(function(n){return Array.isArray(t[n])?t[n].sort().map(function(e){return"".concat(n,"/").concat(e)}):["".concat(n,"/").concat(t[n])]}).join(" ")),e}function $e(e,t){return t&&t.requestHeaderTransform?t.requestHeaderTransform(n({},e)):e}function Be(u,e,s){var r="/a/"+e+".gif",c=q({"Content-Type":"application/json"},Ke(u,s)),l=u.httpFallbackPing,f={};return f.sendChunk=function(e,n,o,t){var i=JSON.stringify(e),a=o?null:X();return t?function t(r){var e=o?c:q({},c,{"X-LaunchDarkly-Event-Schema":"3","X-LaunchDarkly-Payload-ID":a});return u.httpRequest("POST",n,$e(e,s),i).promise.then(function(e){if(e)return 400<=e.status&&g(e.status)&&r?t(!1):(n={status:(e=e).status},(e=(e=e.header("date"))&&Date.parse(e))&&(n.serverTime=e),n);var n}).catch(function(){return r?t(!1):Promise.reject()})}(!0).catch(function(){}):(l&&l(n+r+"?d="+j(i)),Promise.resolve())},f.sendEvents=function(e,n,t){if(!u.httpRequest)return Promise.resolve();for(var r=u.httpAllowsPost(),o=r?[e]:N(2e3-n.length,e),i=[],a=0;a<o.length;a++)i.push(f.sendChunk(o[a],n,t,r));return Promise.all(i)},f}function He(){var e={},a=0,u=0,s={};return e.summarizeEvent=function(e){var n,t;"feature"===e.kind&&(n=e.key+":"+(null!==e.variation&&void 0!==e.variation?e.variation:"")+":"+(null!==e.version&&void 0!==e.version?e.version:""),(t=s[n])?t.count=t.count+1:s[n]={count:1,key:e.key,variation:e.variation,version:e.version,value:e.value,default:e.default},(0===a||e.creationDate<a)&&(a=e.creationDate),e.creationDate>u&&(u=e.creationDate))},e.getSummary=function(){var e,n={},t=!0;for(e in s){var r=s[e],o=n[r.key],i=(o||(o={default:r.default,counters:[]},n[r.key]=o),{value:r.value,count:r.count});void 0!==r.variation&&null!==r.variation&&(i.variation=r.variation),r.version?i.version=r.version:i.unknown=!0,o.counters.push(i),t=!1}return t?null:{startDate:a,endDate:u,features:n}},e.clearSummary=function(){u=a=0,s={}},e}function Ge(e){var n={},a=e.allAttributesPrivate,u=e.privateAttributeNames||[],s={key:!0,custom:!0,anonymous:!0},o={key:!0,secondary:!0,ip:!0,country:!0,email:!0,firstName:!0,lastName:!0,avatar:!0,name:!0,anonymous:!0,custom:!0};return n.filterUser=function(e){if(!e)return null;function n(r,o){return Object.keys(r).reduce(function(e,n){var t;return o(n)&&(s[t=n]||!a&&-1===i.indexOf(t)&&-1===u.indexOf(t)?e[0][n]=r[n]:e[1][n]=!0),e},[{},{}])}var i=e.privateAttributeNames||[],t=n(e,function(e){return o[e]}),r=t[0],t=t[1],e=(e.custom&&(e=n(e.custom,function(){return 1}),r.custom=e[0],t=q({},t,e[1])),Object.keys(t));return e.length&&(e.sort(),r.privateAttrs=e),r},n}function We(n){var e={},o={};return e.on=function(e,n,t){o[e]=o[e]||[],o[e]=o[e].concat({handler:n,context:t})},e.off=function(e,n,t){if(o[e])for(var r=0;r<o[e].length;r++)o[e][r].handler===n&&o[e][r].context===t&&(o[e]=o[e].slice(0,r).concat(o[e].slice(r+1)))},e.emit=function(e){if(o[e])for(var n=o[e].slice(0),t=0;t<n.length;t++)n[t].handler.apply(n[t].context,Array.prototype.slice.call(arguments,1))},e.getEvents=function(){return Object.keys(o)},e.getEventListenerCount=function(e){return o[e]?o[e].length:0},e.maybeReportError=function(e){e&&(o.error?this.emit("error",e):(n||console).error(e.message))},e}var Xe=function(r){var n=!1,t=!1,o=null,e=null,i=new Promise(function(n){r.on("ready",function e(){r.off("ready",e),n()})}).catch(function(){});return{getInitializationPromise:function(){return e||(n?Promise.resolve():t?Promise.reject(o):e=new Promise(function(n,t){r.on("initialized",function e(){r.off("initialized",e),n()}),r.on("failed",function e(n){r.off("failed",e),t(n)})}))},getReadyPromise:function(){return i},signalSuccess:function(){n||t||(n=!0,r.emit("initialized"),r.emit("ready"))},signalFailure:function(e){n||t||(t=!0,o=e,r.emit("failed",e),r.emit("ready")),r.maybeReportError(e)}}};function Qe(n,t,r,o){var i={};function a(){var e="",n=o.getUser();return n&&(e=r||I(JSON.stringify(n))),"ld:"+t+":"+e}return i.loadFlags=function(){return n.get(a()).then(function(e){if(null==e)return null;try{var n,t=JSON.parse(e);return t&&(void 0===(n=t.$schema)||n<1?t=C(t):delete t.$schema),t}catch(e){return i.clearFlags().then(function(){return null})}})},i.saveFlags=function(e){e=q({},e,{$schema:1});return n.set(a(),JSON.stringify(e))},i.clearFlags=function(){return n.clear(a())},i}function Ye(o,i,a,n){var u,s=i.streamUrl,c=i.logger,e={},l=U(s,"/eval/"+a),f=i.useReport,d=i.evaluationReasons,t=i.streamReconnectDelay,v=Ke(o,i),g=!1,p=null,m=null,h=null,y=null,w=null;function b(e){g||(c.warn(De(e,t)),g=!0),S(!1),E(),k(t)}function k(e){m||(e?m=setTimeout(r,e):r())}function r(){m=null;var e,n="",t={headers:v,readTimeoutMillis:3e5};if(o.eventSourceFactory){for(var r in null!=y&&(n="h="+y),f?o.eventSourceAllowsReport?(e=l,t.method="REPORT",t.headers["Content-Type"]="application/json",t.body=JSON.stringify(h)):(e=U(s,"/ping/"+a),n=""):e=l+"/"+j(JSON.stringify(h)),t.headers=$e(t.headers,i),e=e+((n=d?n+(n?"&":"")+"withReasons=true":n)?"?":"")+n,E(),c.info(we(e)),u=(new Date).getTime(),p=o.eventSourceFactory(e,t),w)V(w,r)&&p.addEventListener(r,w[r]);p.onerror=b}}function E(){p&&(c.info("Closing stream connection"),p.close(),p=null)}function S(e){u&&n&&n.recordStreamInit(u,!e,(new Date).getTime()-u),u=null}return e.connect=function(e,n,t){h=e,y=n,w={};for(var r in t||{})!function(n){w[n]=function(e){S(!(g=!1)),t[n]&&t[n](e)}}(r);k()},e.disconnect=function(){clearTimeout(m),m=null,E()},e.isConnected=function(){return!!(p&&o.eventSourceIsActive&&o.eventSourceIsActive(p))},e}function Ze(g,p,i){var a=p.baseUrl,u=p.useReport,c=p.evaluationReasons,l=p.logger,e={},m={};function f(e,n){if(!g.httpRequest)return new Promise(function(e,n){n(new v(be()))});var t,r,o,i,a,u=n?"REPORT":"GET",c=Ke(g,p),l=(n&&(c["Content-Type"]="application/json"),m[e]),f=(l||(t=function(){delete m[e]},(d={addPromise:function(n,e){r=n,o&&o(),o=e,n.then(function(e){r===n&&(i(e),t())},function(e){r===n&&(a(e),t())})}}).resultPromise=new Promise(function(e,n){i=e,a=n}),l=d,m[e]=l),g.httpRequest(u,e,$e(c,p),n)),d=f.promise.then(function(e){if(200!==e.status)return Promise.reject(404===(n=e).status?new s(ce()):new v(fe(n.statusText||String(n.status))));if(e.header("content-type")&&"application/json"===e.header("content-type").substring(0,"application/json".length))return JSON.parse(e.body);var n=oe(e.header("content-type")||"");return Promise.reject(new v(n))},function(e){return Promise.reject(new v(ue(e)))});return l.addPromise(d,function(){f.cancel&&f.cancel()}),l.resultPromise}return e.fetchJSON=function(e){return f(U(a,e),null)},e.fetchFlagSettings=function(e,n){var t,r,o="";return u?(t=[a,"/sdk/evalx/",i,"/user"].join(""),r=JSON.stringify(e)):(e=j(JSON.stringify(e)),t=[a,"/sdk/evalx/",i,"/users/",e].join("")),n&&(o="h="+n),l.debug(Ie(t=t+((o=c?o+(o?"&":"")+"withReasons=true":o)?"?":"")+o)),f(t,r)},e}function en(t){var e={validateUser:function(e){if(!e)return Promise.reject(new c(ve()));var n=T(e);return null!==n.key&&void 0!==n.key?(n.key=n.key.toString(),Promise.resolve(n)):n.anonymous?t.get("ld:$anonUserId").then(function(e){if(e)return n.key=e,n;e=X();return n.key=e,t.set("ld:$anonUserId",e).then(function(){return n})}):Promise.reject(new c(de()))}};return e}var nn=Object.freeze({__proto__:null,baseOptionDefs:Ve,validate:Je,getTags:Me}).baseOptionDefs,tn=z.appendUrlPath,rn=function(e){var n={diagnosticId:X()};return e&&(n.sdkKeySuffix=6<e.length?e.substring(e.length-6):e),n},on=function(e){var n,t,r,o;function i(e){n=e,r=t=0,o=[]}return i(e),{getProps:function(){return{dataSinceDate:n,droppedEvents:t,eventsInLastBatch:r,streamInits:o}},setProps:function(e){n=e.dataSinceDate,t=e.droppedEvents||0,r=e.eventsInLastBatch||0,o=e.streamInits||[]},incrementDroppedEvents:function(){t++},setEventsInLastBatch:function(e){r=e},recordStreamInit:function(e,n,t){o.push({timestamp:e,failed:n,durationMillis:t})},reset:i}},an=function(t,r,e,o,i,a,u){var s,c,l=!!t.diagnosticUseCombinedEvent,f="ld:"+i+":$diagnostics",d=tn(a.eventsUrl,"/events/diagnostic/"+i),v=a.diagnosticRecordingInterval,g=e,p=!!a.streaming,i={};function m(){return{sdk:(e=n({},t.diagnosticSdkData),a.wrapperName&&(e.wrapperName=a.wrapperName),a.wrapperVersion&&(e.wrapperVersion=a.wrapperVersion),e),configuration:{customBaseURI:a.baseUrl!==nn.baseUrl.default,customStreamURI:a.streamUrl!==nn.streamUrl.default,customEventsURI:a.eventsUrl!==nn.eventsUrl.default,eventsCapacity:a.eventCapacity,eventsFlushIntervalMillis:a.flushInterval,reconnectTimeMillis:a.streamReconnectDelay,streamingDisabled:!p,allAttributesPrivate:!!a.allAttributesPrivate,inlineUsersInEvents:!!a.inlineUsersInEvents,diagnosticRecordingIntervalMillis:a.diagnosticRecordingInterval,usingSecureMode:!!a.hash,bootstrapMode:!!a.bootstrap,fetchGoalsDisabled:!a.fetchGoals,allowFrequentDuplicateEvents:!!a.allowFrequentDuplicateEvents,sendEventsOnlyForVariation:!!a.sendEventsOnlyForVariation,autoAliasingOptOut:!!a.autoAliasingOptOut},platform:t.diagnosticPlatformData};var e}function h(e){a.logger&&a.logger.debug(qe.debugPostingDiagnosticEvent(e)),o.sendEvents(e,d,!0).then(function(){}).catch(function(){})}function y(){var e,t;h((t=(new Date).getTime(),e=n({kind:l?"diagnostic-combined":"diagnostic",id:u,creationDate:t},g.getProps()),l&&(e=n(n({},e),m())),g.reset(t),e)),c=setTimeout(y,v),s=(new Date).getTime(),l&&r.isEnabled()&&(t=n({},g.getProps()),r.set(f,JSON.stringify(t)))}return i.start=function(){var t;l?(t=function(e){var n;e?(e=(s||0)+v)<=(n=(new Date).getTime())?y():c=setTimeout(y,e-n):0===Math.floor(4*Math.random())?y():c=setTimeout(y,v)},r.isEnabled()?r.get(f).then(function(e){if(e)try{var n=JSON.parse(e);g.setProps(n),s=n.dataSinceDate}catch(e){}t(!0)}).catch(function(){t(!1)}):t(!1)):(h(n({kind:"diagnostic-init",id:u,creationDate:g.getProps().dataSinceDate},m())),c=setTimeout(y,v))},i.stop=function(){c&&clearTimeout(c)},i.setStreaming=function(e){p=e},i};function un(ee,ne,e,i,r){var a,c,o,f,p,m,te,h,y,w,b,k=e&&e.logger?e.logger:r&&r.logger&&r.logger.default||Z("warn"),E=We(k),S=Xe(E),D=Je(e,E,r,k),O=D.sendEvents,P=ee,j=D.hash,r=(m=i.localStorage,te=k,h=!(e={}),e.isEnabled=function(){return!!m},e.get=function(e){return new Promise(function(n){m?m.get(e).then(n).catch(function(e){ve(e),n(void 0)}):n(void 0)})},e.set=function(e,t){return new Promise(function(n){m?m.set(e,t).then(function(){return n(!0)}).catch(function(e){ve(e),n(!1)}):n(!1)})},e.clear=function(e){return new Promise(function(n){m?m.clear(e).then(function(){return n(!0)}).catch(function(e){ve(e),n(!1)}):n(!1)})},e),e=Be(i,P,D),I=D.sendEvents&&!D.diagnosticOptOut,x=I?rn(P):null,re=I?on((new Date).getTime()):null,C=I?an(i,r,re,e,P,D,x):null,oe=Ye(i,D,P,re),N=D.eventProcessor||function(e,n,t,r,o,i){var a,s=3<arguments.length&&void 0!==r?r:null,c=4<arguments.length&&void 0!==o?o:null,l={},f=(5<arguments.length&&void 0!==i?i:null)||Be(e,t,n),d=U(n.eventsUrl,"/events/bulk/"+t),v=He(),p=Ge(n),m=n.inlineUsersInEvents,h=n.samplingInterval,y=n.eventCapacity,w=n.flushInterval,b=n.logger,k=[],E=0,S=!1,D=!1;function O(){return 0===h||0===Math.floor(Math.random()*h)}function P(e){k.length<y?(k.push(e),D=!1):(D||(D=!0,b.warn("Exceeded event queue capacity. Increase capacity to avoid dropping events.")),s&&s.incrementDroppedEvents())}return l.enqueue=function(e){var n,t,r;S||(n=t=!1,v.summarizeEvent(e),"feature"===e.kind?O()&&(t=!!e.trackEvents,n=!!(r=e).debugEventsUntilDate&&r.debugEventsUntilDate>E&&r.debugEventsUntilDate>(new Date).getTime()):t=O(),t&&P((t=q({},r=e),"alias"!==r.kind&&(m||"identify"===r.kind?t.user=p.filterUser(r.user):(t.userKey=r.user.key,delete t.user),"feature"===r.kind&&(delete t.trackEvents,delete t.debugEventsUntilDate)),t)),n&&((t=q({},e,{kind:"debug"})).user=p.filterUser(t.user),delete t.trackEvents,delete t.debugEventsUntilDate,P(t)))},l.flush=function(){if(S)return Promise.resolve();var e=k,n=v.getSummary();return v.clearSummary(),n&&(n.kind="summary",e.push(n)),s&&s.setEventsInLastBatch(e.length),0===e.length?Promise.resolve():(k=[],b.debug(Ne(e.length)),f.sendEvents(e,d).then(function(e){e&&(e.serverTime&&(E=e.serverTime),g(e.status)||(S=!0),400<=e.status&&A(function(){c.maybeReportError(new u(he(e.status,"event posting","some events were dropped")))}))}))},l.start=function(){a=setTimeout(function e(){l.flush(),a=setTimeout(e,w)},w)},l.stop=function(){clearTimeout(a)},l}(i,D,P,re,E,e),z=Ze(i,D,P),ie={},M={},K=D.streaming,ue=!1,J=!1,ce=!0,$=D.stateProvider,B=(f=function(e,n){$||e&&H({kind:"identify",key:e.key,user:e,creationDate:(new Date).getTime()}),!D.autoAliasingOptOut&&n&&n.anonymous&&e&&!e.anonymous&&ye(e,n)},{setUser:function(e){var n=p&&T(p);(p=_(e))&&f&&f(T(p),n)},getUser:function(){return p?T(p):null}}),de=en(r),G=r.isEnabled()?new Qe(r,P,j,B,k):null;function ve(e){h||(h=!0,te.warn(ae(e)))}function H(e){if(P&&!($&&$.enqueueEvent&&$.enqueueEvent(e))){if("alias"!==e.kind){if(!e.user)return void(ce&&(k.warn("Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"),ce=!1));ce=!1}!O||J||i.isDoNotTrack()||(k.debug(Fe(e.kind)),N.enqueue(e))}}function ge(e,n,t,r){var o=B.getUser(),i=new Date,a=n?n.value:null;if(!D.allowFrequentDuplicateEvents){var u=JSON.stringify(a)+(o&&o.key?o.key:"")+e,s=ie[u];if(s&&i-s<3e5)return;ie[u]=i}s={kind:"feature",key:e,user:o,value:a,variation:n?n.variationIndex:null,default:t,creationDate:i.getTime()},o&&o.anonymous&&(s.contextKind=W(o)),u=M[e];u&&(s.version=u.flagVersion||u.version,s.trackEvents=u.trackEvents,s.debugEventsUntilDate=u.debugEventsUntilDate),(r||u&&u.trackReason)&&n&&(s.reason=n.reason),H(s)}function me(e,n,t,r){var o,i;return M&&V(M,e)&&M[e]&&!M[e].deleted?(i=X(o=M[e]),null!==o.value&&void 0!==o.value||(i.value=n)):i={value:n,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}},t&&ge(e,i,n,r),i}function X(e){return{value:e.value,variationIndex:void 0===e.variation?null:e.variation,reason:e.reason||null}}function W(e){return e.anonymous?"anonymousUser":"user"}function ye(e,n){$||e&&n&&H({kind:"alias",key:e.key,contextKind:W(e),previousKey:n.key,previousContextKind:W(n),creationDate:(new Date).getTime()})}function we(){var o;c=!0,B.getUser()&&(o=function(e){try{return JSON.parse(e)}catch(e){return void E.maybeReportError(new d("Invalid data received from LaunchDarkly; connection may have been interrupted"))}},oe.connect(B.getUser(),j,{ping:function(){k.debug("received ping message from stream");var n=B.getUser();z.fetchFlagSettings(n,j).then(function(e){R(n,B.getUser())&&Q(e||{})}).catch(function(e){E.maybeReportError(new v(fe(e)))})},put:function(e){e=o(e.data);e&&(k.debug("received streaming update for all flags"),Q(e))},patch:function(e){var n,t,r,e=o(e.data);e&&(!(n=M[e.key])||!n.version||!e.version||n.version<e.version?(k.debug(Re(e.key)),t={},delete(r=q({},e)).key,r=X(M[e.key]=r),t[e.key]=n?{previous:n.value,current:r}:{current:r},ke(t)):k.debug(Ae(e.key)))},delete:function(e){var n,e=o(e.data);e&&(!M[e.key]||M[e.key].version<e.version?(k.debug(Le(e.key)),n={},M[e.key]&&!M[e.key].deleted&&(n[e.key]={previous:M[e.key].value}),M[e.key]={version:e.version,deleted:!0},ke(n)):k.debug(Ce(e.key)))}}))}function be(){c&&(oe.disconnect(),c=!1)}function Q(e){var t,r,o={};if(!e)return Promise.resolve();for(t in M)V(M,t)&&M[t]&&(e[t]&&!R(e[t].value,M[t].value)?o[t]={previous:M[t].value,current:X(e[t])}:e[t]&&!e[t].deleted||(o[t]={previous:M[t].value}));for(r in e)V(e,r)&&e[r]&&(!M[r]||M[r].deleted)&&(o[r]={current:X(e[r])});return M=n({},e),ke(o).catch(function(){})}function ke(o){var i,e=Object.keys(o);return 0<e.length&&(i={},e.forEach(function(e){var n=o[e].current,t=n?n.value:void 0,r=o[e].previous;E.emit("change:"+e,t,r),i[e]=n?{current:t,previous:r}:{previous:r}}),E.emit("change",i),E.emit("internal-change",M),D.sendEventsOnlyForVariation||$||e.forEach(function(e){ge(e,o[e].current)})),a&&G?G.saveFlags(M):Promise.resolve()}function Ee(){var e=K||o&&void 0===K;e&&!c?we():!e&&c&&be(),C&&C.setStreaming(e)}function Se(e){return"change"===e||"change:"===e.substr(0,"change".length+1)}function De(e){P=e.environment,B.setUser(e.user),M=n({},e.flags),A(Y)}function Y(){k.info("LaunchDarkly client initialized"),ue=!0,Ee(),S.signalSuccess()}function Oe(e){S.signalFailure(e)}return"string"==typeof D.bootstrap&&"LOCALSTORAGE"===D.bootstrap.toUpperCase()&&(G?a=!0:k.warn(ae())),"object"===t(D.bootstrap)&&(y=D.bootstrap,I=Object.keys(y),!(w=y.$flagsState)&&I.length&&k.warn(pe()),!1===y.$valid&&k.warn("LaunchDarkly bootstrap data is not available because the back end could not read the flags."),b={},I.forEach(function(e){var n;"$flagsState"!==e&&"$valid"!==e&&(n={value:y[e]},w&&w[e]?n=q(n,w[e]):n.version=0,b[e]=n)}),M=b),$?((x=$.getInitialState())?De(x):$.on("init",De),$.on("update",function(e){e.user&&B.setUser(e.user),e.flags&&Q(e.flags)})):(ee?de.validateUser(ne).then(function(e){return B.setUser(e),"object"===t(D.bootstrap)?Y():a?G.loadFlags().then(function(e){return null==e?(M={},z.fetchFlagSettings(B.getUser(),j).then(function(e){return Q(e||{})}).then(Y).catch(function(e){Oe(new v(fe(e)))})):(M=e,A(Y),z.fetchFlagSettings(B.getUser(),j).then(Q).catch(function(e){return E.maybeReportError(e)}))}):z.fetchFlagSettings(B.getUser(),j).then(function(e){M=e||{},Y()}).catch(function(e){M={},Oe(e)})}):Promise.reject(new s(le()))).catch(Oe),{client:{waitForInitialization:function(){return S.getInitializationPromise()},waitUntilReady:function(){return S.getReadyPromise()},identify:function(e,r,n){return J?L(Promise.resolve({}),n):$?(k.warn("identify() has no effect here; it must be called on the main client instance"),L(Promise.resolve(F(M)),n)):L((a&&G?G.clearFlags():Promise.resolve()).then(function(){return de.validateUser(e)}).then(function(t){return z.fetchFlagSettings(t,r).then(function(e){var n=F(e);return B.setUser(t),j=r,e?Q(e).then(function(){return n}):n})}).then(function(e){return c&&we(),e}).catch(function(e){return E.maybeReportError(e),Promise.reject(e)}),n)},getUser:function(){return B.getUser()},variation:function(e,n){return me(e,n,!0,!1).value},variationDetail:function(e,n){return me(e,n,!0,!0)},track:function(e,n,t){var r,o;"string"==typeof e?(i.customEventFilter&&!i.customEventFilter(e)&&k.warn(se(e)),o={kind:"custom",key:e,user:r=B.getUser(),url:i.getCurrentUrl(),creationDate:(new Date).getTime()},r&&r.anonymous&&(o.contextKind=W(r)),null!=n&&(o.data=n),null!=t&&(o.metricValue=t),H(o)):E.maybeReportError(new l(se(e)))},alias:ye,on:function(e,n,t){Se(e)?(o=!0,ue&&Ee(),E.on(e,n,t)):E.on.apply(E,arguments)},off:function(e){var n;E.off.apply(E,arguments),Se(e)&&(n=!1,E.getEvents().forEach(function(e){Se(e)&&0<E.getEventListenerCount(e)&&(n=!0)}),n||(o=!1,c&&void 0===K&&be()))},setStreaming:function(e){e=null===e?void 0:e;e!==K&&(K=e,Ee())},flush:function(e){return L(O?N.flush():Promise.resolve(),e)},allFlags:function(){var e,n={};if(!M)return n;for(e in M)V(M,e)&&(n[e]=me(e,null,!D.sendEventsOnlyForVariation).value);return n},close:function(e){if(J)return L(Promise.resolve(),e);function n(){J=!0,M={}}return L(Promise.resolve().then(function(){if(be(),C&&C.stop(),O)return N.stop(),N.flush()}).then(n).catch(n),e)}},options:D,emitter:E,ident:B,logger:k,requestor:z,start:function(){O&&(C&&C.start(),N.start())},enqueueEvent:H,getFlagsInternal:function(){return M},getEnvironmentId:function(){return P},internalChangeEventName:"internal-change"}}var sn="3.6.0",ldclientCommon_es=Object.freeze({__proto__:null,commonBasicLogger:Y,createConsoleLogger:Z,errors:p,initialize:un,messages:qe,utils:z,version:sn});function ownKeys(n,e){var t,r=Object.keys(n);return Object.getOwnPropertySymbols&&(t=Object.getOwnPropertySymbols(n),e&&(t=t.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),r.push.apply(r,t)),r}function _objectSpread2(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(e){_defineProperty(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var commonBasicLogger=ldclientCommon_es.commonBasicLogger;function basicLogger(e){return commonBasicLogger(_objectSpread2({destination:console.log},e))}var basicLogger_1={basicLogger:basicLogger},basicLogger_2=basicLogger_1.basicLogger;function isSyncXhrSupported(){var e=window.navigator&&window.navigator.userAgent;if(e){e=e.match(/Chrom(e|ium)\/([0-9]+)\./);if(e)return parseInt(e[2],10)<73}return!0}var emptyResult={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function newHttpRequest(e,n,t,r,o){if(o&&!isSyncXhrSupported())return emptyResult;var i,a,u=new window.XMLHttpRequest;for(i in u.open(e,n,!o),t||{})Object.prototype.hasOwnProperty.call(t,i)&&u.setRequestHeader(i,t[i]);return o?(u.send(r),emptyResult):{promise:new Promise(function(e,n){u.addEventListener("load",function(){a||e({status:u.status,header:function(e){return u.getResponseHeader(e)},body:u.responseText})}),u.addEventListener("error",function(){a||n(new Error)}),u.send(r)}),cancel:function(){a=!0,u.abort()}}}function makeBrowserPlatform(e){var i,n,a={synchronousFlush:!1},t=(window.XMLHttpRequest&&(i=e&&e.disableSyncEventPost,a.httpRequest=function(e,n,t,r){var o=a.synchronousFlush&!i;return a.synchronousFlush=!1,newHttpRequest(e,n,t,r,o)}),a.httpAllowsPost=function(){return n=void 0===n?!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest:n},a.httpFallbackPing=function(e){(new window.Image).src=e},e&&e.eventUrlTransformer);a.getCurrentUrl=function(){return t?t(window.location.href):window.location.href},a.isDoNotTrack=function(){var e=window.navigator&&void 0!==window.navigator.doNotTrack?window.navigator.doNotTrack:window.navigator&&void 0!==window.navigator.msDoNotTrack?window.navigator.msDoNotTrack:window.doNotTrack;return 1===e||!0===e||"1"===e||"yes"===e};try{window.localStorage&&(a.localStorage={get:function(n){return new Promise(function(e){e(window.localStorage.getItem(n))})},set:function(n,t){return new Promise(function(e){window.localStorage.setItem(n,t),e()})},clear:function(n){return new Promise(function(e){window.localStorage.removeItem(n),e()})}})}catch(e){a.localStorage=null}var r=e&&e.useReport&&"function"==typeof window.EventSourcePolyfill&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(a.eventSourceAllowsReport=!0,window.EventSourcePolyfill):(a.eventSourceAllowsReport=!1,window.EventSource);return window.EventSource&&(a.eventSourceFactory=function(e,n){n=_objectSpread2(_objectSpread2({},{heartbeatTimeout:3e5,silentTimeout:3e5,skipDefaultHeaders:!0}),n);return new r(e,n)},a.eventSourceIsActive=function(e){return e.readyState===window.EventSource.OPEN||e.readyState===window.EventSource.CONNECTING}),a.userAgent="JSClient",a.version="2.22.1",a.diagnosticSdkData={name:"js-client-sdk",version:"2.22.1"},a.diagnosticPlatformData={name:"JS"},a.diagnosticUseCombinedEvent=!0,a}var matchOperatorsRe=/[|\\{}()[\]^$+*?.]/g,escapeStringRegexp=function(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(matchOperatorsRe,"\\$&")};function doesUrlMatch(e,n,t,r){var o,i,a=(("substring"===e.kind||"regex"===e.kind)&&r.includes("/")?n:n.replace(r,"")).replace(t,"");switch(e.kind){case"exact":i=n,o=new RegExp("^"+escapeStringRegexp(e.url)+"/?$");break;case"canonical":i=a,o=new RegExp("^"+escapeStringRegexp(e.url)+"/?$");break;case"substring":i=a,o=new RegExp(".*"+escapeStringRegexp(e.substring)+".*$");break;case"regex":i=a,o=new RegExp(e.pattern);break;default:return!1}return o.test(i)}function findGoalsForClick(e,n){for(var t=[],r=0;r<n.length;r++)for(var o=e.target,i=n[r],a=i.selector,u=document.querySelectorAll(a);o&&0<u.length;){for(var s=0;s<u.length;s++)o===u[s]&&t.push(i);o=o.parentNode}return t}function GoalTracker(e,r){for(var n={},t=null,o=[],i=0;i<e.length;i++)for(var a=e[i],u=a.urls||[],s=0;s<u.length;s++)if(doesUrlMatch(u[s],window.location.href,window.location.search,window.location.hash)){"pageview"===a.kind?r("pageview",a):(o.push(a),r("click_pageview",a));break}return 0<o.length&&(t=function(e){for(var n=findGoalsForClick(e,o),t=0;t<n.length;t++)r("click",n[t])},document.addEventListener("click",t)),n.dispose=function(){document.removeEventListener("click",t)},n}var locationWatcherInterval=300;function GoalManager(o,n){var t,r;function i(){r&&r.dispose(),t&&t.length&&(r=GoalTracker(t,a))}function a(e,n){var t=o.ident.getUser(),r={kind:e,key:n.key,data:null,url:window.location.href,user:t,creationDate:(new Date).getTime()};return t&&t.anonymous&&(r.contextKind="anonymousUser"),"click"===e&&(r.selector=n.selector),o.enqueueEvent(r)}function u(e,n){var t,r=window.location.href;function o(){(t=window.location.href)!==r&&(r=t,n())}!function e(n,t){n(),setTimeout(function(){e(n,t)},t)}(o,e),window.history&&window.history.pushState?window.addEventListener("popstate",o):window.addEventListener("hashchange",o)}return o.requestor.fetchJSON("/sdk/goals/"+o.getEnvironmentId()).then(function(e){e&&0<e.length&&(r=GoalTracker(t=e,a),u(locationWatcherInterval,i)),n()}).catch(function(e){o.emitter.maybeReportError(new p.LDUnexpectedResponseError((e&&e.message,e.message))),n()}),{}}var goalsEvent="goalsReady",extraOptionDefs={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function initialize(e,n){function t(){o.synchronousFlush=!0,i.flush().catch(function(){}),o.synchronousFlush=!1}var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=makeBrowserPlatform(r),e=un(e,n,r,o,extraOptionDefs),i=e.client,n=e.options,a=e.emitter,u=new Promise(function(e){var n=a.on(goalsEvent,function(){a.off(goalsEvent,n),e()})});i.waitUntilGoalsReady=function(){return u},n.fetchGoals?GoalManager(e,function(){return a.emit(goalsEvent)}):a.emit(goalsEvent),"complete"!==document.readyState?window.addEventListener("load",e.start):e.start();return window.addEventListener("beforeunload",t),window.addEventListener("unload",t),i}var basicLogger$1=basicLogger_2,createConsoleLogger=Z,version="2.22.1";function deprecatedInitialize(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};return console&&console.warn&&console.warn(qe.deprecated("default export","named LDClient export")),initialize(e,n,t)}var index={initialize:deprecatedInitialize,version:version};exports.basicLogger=basicLogger$1,exports.createConsoleLogger=createConsoleLogger,exports.default=index,exports.initialize=initialize,exports.version=version;
//# sourceMappingURL=ldclient.cjs.js.map
